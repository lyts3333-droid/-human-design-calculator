# 診斷連接問題指南

## 問題：前端無法連接到後端伺服器

### 步驟 1：確認伺服器正在運行

在命令提示符中，您應該看到：
```
* Debugger is active!
* Running on http://0.0.0.0:5000
```

### 步驟 2：測試伺服器是否響應

打開瀏覽器，訪問：
- http://localhost:5000/health

您應該看到一個 JSON 響應，類似：
```json
{
  "status": "healthy",
  "message": "Human Design API is running",
  ...
}
```

### 步驟 3：檢查瀏覽器控制台

1. 在瀏覽器中打開開發者工具（按 F12）
2. 切換到「Console」（控制台）標籤
3. 點擊「計算人類圖」按鈕
4. 查看是否有錯誤訊息

常見錯誤：
- `Failed to fetch` - 通常表示伺服器未運行或無法連接
- `CORS error` - 跨域問題（但我們已經啟用了 CORS）
- `Network error` - 網絡連接問題

### 步驟 4：檢查伺服器日誌

在運行 `app.py` 的命令提示符窗口中，查看是否有錯誤訊息。

如果看到 Python 錯誤（如 ImportError, AttributeError 等），這就是問題所在。

### 步驟 5：測試 API 端點

在瀏覽器或使用 curl 測試：
```bash
curl -X POST http://localhost:5000/calculate_hd \
  -H "Content-Type: application/json" \
  -d "{\"year\":1990,\"month\":5,\"day\":15,\"time\":\"14:30\"}"
```

### 可能的原因和解決方案

#### 1. 伺服器未正確啟動
- **解決方案**：確保在正確的目錄中運行 `python app.py`
- 檢查是否有錯誤訊息

#### 2. pyswisseph 導入失敗
- **解決方案**：運行 `pip install pyswisseph`
- 如果安裝失敗，系統會回退到模擬數據

#### 3. 端口被占用
- **解決方案**：更改 `app.py` 中的端口號（例如改為 5001）
- 同時更新前端中的 URL（如果需要）

#### 4. 防火牆阻擋
- **解決方案**：檢查 Windows 防火牆設置
- 確保允許 Python 通過防火牆

### 步驟 6：使用測試腳本

運行測試腳本：
```bash
python test_api_connection.py
```

這會測試 API 連接並顯示詳細的錯誤信息。

### 如果問題仍然存在

請提供以下信息：
1. 瀏覽器控制台中的完整錯誤訊息
2. 伺服器終端中的完整錯誤訊息
3. 訪問 http://localhost:5000/health 時看到的内容













