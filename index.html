<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººé¡åœ–è¨ˆç®—å™¨ - Web æ‡‰ç”¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'å¾®è»Ÿæ­£é»‘é«”', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .input-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .input-section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-item {
            display: flex;
            flex-direction: column;
        }

        .form-item label {
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-item input,
        .form-item select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
            background: white;
        }

        .form-item input:focus,
        .form-item select:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .results-section {
            display: grid;
            grid-template-columns: 1fr 1.6fr;
            gap: 30px;
            margin-top: 30px;
        }

        @media (max-width: 1024px) {
            .results-section {
                grid-template-columns: 1fr;
            }
        }

        .section {
            background: 
                linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%),
                radial-gradient(circle at 20% 50%, rgba(100, 200, 255, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(100, 255, 200, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 50% 20%, rgba(255, 200, 100, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 50% 80%, rgba(255, 100, 200, 0.06) 0%, transparent 50%);
            background-size: 
                100% 100%,
                300px 300px,
                300px 300px,
                300px 300px,
                300px 300px;
            background-position: 
                0% 0%,
                0% 0%,
                100% 100%,
                50% 0%,
                50% 100%;
            background-repeat: no-repeat;
            border-radius: 15px;
            padding: 25px;
            position: relative;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.6em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        /* Body Graph å®¹å™¨æ¨£å¼ - ä½¿ç”¨ Grid ä½ˆå±€ï¼ˆåƒ…å·¦å³å…©æ¬„ï¼‰ */
        #body-graph-container {
            width: 100%;
            height: auto;
            min-height: 600px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            background: 
                linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%),
                radial-gradient(circle at 20% 50%, rgba(100, 200, 255, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(100, 255, 200, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 50% 20%, rgba(255, 200, 100, 0.06) 0%, transparent 50%),
                radial-gradient(circle at 50% 80%, rgba(255, 100, 200, 0.06) 0%, transparent 50%);
            background-size: 
                100% 100%,
                300px 300px,
                300px 300px,
                300px 300px,
                300px 300px;
            background-position: 
                0% 0%,
                0% 0%,
                100% 100%,
                50% 0%,
                50% 100%;
            background-repeat: no-repeat;
            border-radius: 10px;
            padding: 20px;
            position: relative;
        }

        @media (max-width: 768px) {
            #body-graph-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto;
            }
        }

        /* å´é‚Šæ¬„æ¨£å¼ */
        .planet-sidebar {
            display: flex;
            flex-direction: column;
            border-radius: 10px;
            padding: 20px;
        }

        .sidebar-design {
            background: #ffe6e6;  /* æ·ºç´…åº•è‰² */
            border: 2px solid #ff9999;
        }

        .sidebar-personality {
            background: #f0f0f0;  /* æ·ºç°åº•è‰² */
            border: 2px solid #cccccc;
        }

        .sidebar-title {
            font-size: 1.6em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 18px;
            padding: 13px;
            border-radius: 8px;
            color: #333;
        }

        .sidebar-design .sidebar-title {
            background: rgba(255, 200, 200, 0.5);
            color: #8b0000;
        }

        .sidebar-personality .sidebar-title {
            background: rgba(200, 200, 200, 0.5);
            color: #333;
        }

        /* è¡Œæ˜Ÿåˆ—è¡¨é … */
        .planet-item {
            display: flex;
            align-items: center;
            padding: 14px 12px;
            margin-bottom: 12px;
            border-radius: 8px;
            transition: background 0.2s;
            font-size: 1.25em;
        }

        .planet-item:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .planet-icon {
            width: 42px;
            height: 42px;
            margin-right: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.6em;
            border-radius: 50%;
            flex-shrink: 0;
            line-height: 1;
        }

        .sidebar-design .planet-icon {
            background: #ffcccc;
            color: #8b0000;
        }

        .sidebar-personality .planet-icon {
            background: #d0d0d0;
            color: #333;
        }

        .planet-name {
            flex: 0 0 90px;
            font-weight: 500;
            font-size: 1.2em;
        }

        .planet-gate-line {
            flex: 0 0 115px;
            text-align: center;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            display: flex;
            align-items: baseline;
            justify-content: center;
            gap: 3px;
        }

        .gate-number {
            font-size: 1.5em;
            font-weight: 700;
            color: #333;
        }
        
        .sidebar-design .gate-number {
            color: #8b0000;  /* æ·±ç´…è‰² */
        }

        .gate-separator {
            font-size: 1.5em;
            color: #999;
        }

        .line-number {
            font-size: 1em;
            color: #666;
            font-weight: 500;
        }
        
        /* æ˜Ÿåº§ç¬¦è™Ÿæ¨£å¼ */
        .zodiac-symbol {
            font-size: 1.4em;
            margin-right: 5px;
            color: #667eea;
            font-weight: bold;
        }
        
        /* å‡é™·ç®­é ­æ¨£å¼ */
        .arrow-ascending {
            color: #28a745;  /* ç¶ è‰² */
            font-size: 1.3em;
            margin-left: 5px;
            font-weight: bold;
            display: inline-block;
        }
        
        .arrow-descending {
            color: #dc3545;  /* ç´…è‰² */
            font-size: 1.3em;
            margin-left: 5px;
            font-weight: bold;
            display: inline-block;
        }

        .planet-sign {
            flex: 1;
            text-align: right;
            font-size: 1.2em;
            color: #666;
        }

        #body-graph {
            width: 100%;
            max-width: 600px;
            height: auto;
        }

        /* èƒ½é‡ä¸­å¿ƒæ¨£å¼ */
        .energy-center {
            stroke: #333;
            stroke-width: 2;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .energy-center.defined {
            fill: #4a90e2;
            stroke: #2c5aa0;
            stroke-width: 3;
        }

        .energy-center.undefined {
            fill: #e8e8e8;
            stroke: #999;
            stroke-width: 2;
        }

        .energy-center:hover {
            filter: brightness(1.1);
        }

        /* é€šé“æ¨£å¼ */
        .channel {
            stroke: #ccc;
            stroke-width: 2;
            fill: none;
            transition: all 0.3s ease;
        }

        .channel.defined {
            stroke: #4a90e2;
            stroke-width: 4;
        }

        .channel.undefined {
            stroke: #e0e0e0;
            stroke-width: 2;
            stroke-dasharray: 5,5;
        }

        /* ä¸­å¿ƒæ¨™ç±¤ */
        .center-label {
            font-size: 12px;
            font-weight: bold;
            fill: #333;
            pointer-events: none;
            text-anchor: middle;
        }

        .center-label.defined {
            fill: white;
        }

        /* çµæœè¡¨æ ¼æ¨£å¼ */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .results-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-size: 1.1em;
        }

        .results-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .results-table tr:hover {
            background: #f0f0f0;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .status-defined {
            background: #4a90e2;
            color: white;
        }

        .status-undefined {
            background: #e8e8e8;
            color: #666;
        }

        .type-badge {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.4em;
            font-weight: bold;
            color: white;
            margin: 5px 0;
        }

        .type-generator {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .type-manifestor {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .type-projector {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .type-reflector {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .info-box {
            background: white;
            border-left: 4px solid #667eea;
            padding: 18px;
            margin: 18px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .info-box.highlight-box {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fff9e6 0%, #ffffff 100%);
        }

        .info-box.warning-box {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, #fef2f2 0%, #ffffff 100%);
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 12px;
            font-size: 1.6em;
            font-weight: 600;
        }

        .info-box.highlight-box h3 {
            color: #f59e0b;
        }

        .info-box.warning-box h3 {
            color: #ef4444;
        }

        .info-box p {
            color: #666;
            line-height: 1.8;
            font-size: 1.4em;
            margin: 0;
        }

        .profile-badge {
            display: inline-block;
            font-size: 3em;
            font-weight: bold;
            color: #f59e0b;
            font-family: 'Courier New', monospace;
            background: white;
            padding: 15px 25px;
            border-radius: 8px;
            border: 2px solid #f59e0b;
            box-shadow: 0 2px 4px rgba(245, 158, 11, 0.2);
        }

        .strategy-text, .authority-text, .definition-text {
            font-weight: 500;
            color: #333;
            font-size: 1.5em;
        }

        .theme-text {
            font-weight: 600;
            color: #ef4444;
            font-size: 1.5em;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #dc3545;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #28a745;
        }

        .hidden {
            display: none;
        }

        .hidden-field {
            display: none !important;
        }
        
        
        /* åœ“å½¢äººé¡åœ–è¡¨æ¨£å¼ */
        
        /* åŸºå› å¤©å‘½ (Gene Keys) æ¨£å¼ - 5x5 ç¶²æ ¼ç³»çµ± */
        #gene-keys-section {
            margin-top: 40px;
        }
        
        #gene-keys-container {
            position: relative;
            width: 100%;
            min-height: 1200px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 40px;
            overflow: visible;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* ç”Ÿå‘½ä¹‹èŠ±èƒŒæ™¯åœ–æ¡ˆ */
        #gene-keys-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(100, 200, 255, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(100, 255, 200, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 50% 20%, rgba(255, 200, 100, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 50% 80%, rgba(255, 100, 200, 0.03) 0%, transparent 50%);
            background-size: 300px 300px, 300px 300px, 300px 300px, 300px 300px;
            background-position: 0% 0%, 100% 100%, 50% 0%, 50% 100%;
            background-repeat: no-repeat;
            opacity: 0.4;
            z-index: 0;
        }
        
        .gene-keys-wrapper {
            position: relative;
            width: 900px;
            height: 900px;
            margin: -20px auto 0 -30px;
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 100px;
            z-index: 10;
            align-items: center;
            justify-items: center;
            padding: 60px;
        }
        
        .gene-keys-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        
        /* ç¢ºä¿ SVG é€£ç·šåœ¨çƒé«”ä¸‹æ–¹ */
        .gene-keys-svg {
            z-index: 0;
        }
        
        .gene-keys-wrapper {
            z-index: 10;
        }
        
        .gene-keys-svg path {
            fill: none;
        }
        
        .gene-key-sphere {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: grid;
            grid-template-columns: 1fr 2fr 1fr;
            grid-template-rows: 1fr 2fr 1fr;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
            z-index: 10;
            padding: 5px;
            box-sizing: border-box;
        }
        
        .gene-key-sphere:hover {
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* å°æ–¼æ²’æœ‰è‡ªå®šç¾© transform çš„çƒé«”ï¼Œhover æ™‚æ‡‰ç”¨ scale */
        .gene-key-sphere:not([data-transform]):hover {
            transform: scale(1.15);
        }
        
        /* å°æ–¼æœ‰è‡ªå®šç¾© transform çš„çƒé«”ï¼Œhover æ™‚åœ¨åŸæœ‰ transform åŸºç¤ä¸ŠåŠ ä¸Š scale */
        .gene-key-sphere[data-transform]:hover {
            transform: var(--original-transform);
        }
        
        .gene-key-sphere.blue {
            /* çç åºåˆ— - å¯¶è—è‰²ç³» */
            background: radial-gradient(circle at 30% 30%, #3498db, #21618c);
            color: white;
        }
        
        .gene-key-sphere.green {
            /* å•Ÿå‹•åºåˆ— - ç¶ è‰²æ”¾å°„ç‹€æ¼¸å±¤ */
            background: radial-gradient(circle at 30% 30%, #76a07b, #2d4d32);
            color: white;
        }
        
        .gene-key-sphere.orange {
            /* é‡‘æ˜Ÿåºåˆ— - æ·±ç´…/é…’ç´…è‰²ç³» */
            background: radial-gradient(circle at 30% 30%, #c0392b, #7b241c);
            color: white;
        }
        
        .gene-key-gate {
            font-size: 2em;
            font-weight: 900;
            line-height: 1;
            text-align: center;
            position: relative;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .gene-key-line {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.75em;
            font-weight: 600;
            color: #cccccc;
            opacity: 0.8;
        }
        
        .gene-key-label {
            font-size: 0.75em;
            text-align: center;
            margin-top: 5px;
            font-weight: 600;
            line-height: 1.2;
            color: #ffffff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        .gene-key-desc {
            font-size: 0.65em;
            text-align: center;
            margin-top: 2px;
            opacity: 0.85;
            font-style: italic;
            color: #e0e0e0;
        }
        
        /* åŸºå› å¤©å‘½çƒé«”ä½¿ç”¨èˆ‡åœ“å½¢åœ–è¡¨ç›¸åŒçš„æ–‡å­—æ ¼å¼ */
        .gene-key-sphere .planet-marker-name {
            grid-column: 1 / 4;
            grid-row: 1;
            font-size: 0.7em;
            text-align: center;
            font-weight: 600;
            align-self: center;
        }
        
        .gene-key-sphere .planet-marker-house {
            grid-column: 1;
            grid-row: 2;
            font-size: 0.7em;
            text-align: center;
            align-self: center;
            justify-self: center;
        }
        
        .gene-key-sphere .planet-marker-gate {
            grid-column: 2;
            grid-row: 2;
            font-size: 2.5em;
            font-weight: 900;
            text-align: center;
            align-self: center;
            justify-self: center;
        }
        
        .gene-key-sphere .planet-marker-line {
            grid-column: 3;
            grid-row: 2;
            font-size: 0.7em;
            text-align: center;
            align-self: center;
            justify-self: center;
        }
        
        .gene-key-sphere .planet-marker-zodiac {
            grid-column: 1 / 4;
            grid-row: 3;
            font-size: 0.65em;
            text-align: center;
            align-self: center;
        }
        
        /* ç¢ºä¿æ–‡å­—é¡è‰²æ­£ç¢ºï¼ˆä½¿ç”¨ç™½è‰²æ–‡å­—ï¼‰ */
        .gene-key-sphere .planet-marker-name,
        .gene-key-sphere .planet-marker-gate,
        .gene-key-sphere .planet-marker-line,
        .gene-key-sphere .planet-marker-zodiac {
            color: #ffffff;
        }
        
        .gene-key-sphere.green .planet-marker-name,
        .gene-key-sphere.green .planet-marker-gate,
        .gene-key-sphere.green .planet-marker-line,
        .gene-key-sphere.green .planet-marker-zodiac {
            color: #ffffff;
        }
        
        .gene-key-sphere.blue .planet-marker-name,
        .gene-key-sphere.blue .planet-marker-gate,
        .gene-key-sphere.blue .planet-marker-line,
        .gene-key-sphere.blue .planet-marker-zodiac {
            color: #ffffff;
        }
        
        .gene-key-sphere.orange .planet-marker-name,
        .gene-key-sphere.orange .planet-marker-gate,
        .gene-key-sphere.orange .planet-marker-line,
        .gene-key-sphere.orange .planet-marker-zodiac {
            color: #ffffff;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒŸ äººé¡åœ–è¨ˆç®—å™¨</h1>
            <p>Human Design Calculator - Web Application</p>
        </div>

        <div class="content">
            <!-- è¼¸å…¥è¡¨å–®å€åŸŸ -->
            <div class="input-section">
                <h2>è¼¸å…¥å‡ºç”Ÿè³‡æ–™</h2>
                <form id="birth-form">
                    <div class="form-group">
                        <div class="form-item">
                            <label for="year">å¹´ä»½ (Year)</label>
                            <input type="number" id="year" name="year" min="1900" max="2100" 
                                   required placeholder="ä¾‹å¦‚ï¼š2002">
                        </div>
                        <div class="form-item">
                            <label for="month">æœˆä»½ (Month)</label>
                            <input type="number" id="month" name="month" min="1" max="12" 
                                   required placeholder="ä¾‹å¦‚ï¼š9">
                        </div>
                        <div class="form-item">
                            <label for="day">æ—¥æœŸ (Day)</label>
                            <input type="number" id="day" name="day" min="1" max="31" 
                                   required placeholder="ä¾‹å¦‚ï¼š21">
                        </div>
                        <div class="form-item">
                            <label for="time">æ™‚é–“ (Time)</label>
                            <input type="time" id="time" name="time" 
                                   required>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="form-item">
                            <label for="county">ç¸£å¸‚ (County)</label>
                            <select id="county" name="county" required>
                                <option value="">è«‹é¸æ“‡ç¸£å¸‚</option>
                            </select>
                        </div>
                        <div class="form-item">
                            <label for="district">å€åŸŸ/é„‰é® (District)</label>
                            <select id="district" name="district" required>
                                <option value="">è«‹å…ˆé¸æ“‡ç¸£å¸‚</option>
                            </select>
                        </div>
                    </div>
                    <!-- éš±è—æ¬„ä½ï¼šä½¿ç”¨ data å±¬æ€§å­˜å„²ï¼Œä¸åƒèˆ‡è¡¨å–®é©—è­‰ -->
                    <input type="hidden" id="timezone" value="Asia/Shanghai">
                    <input type="hidden" id="longitude" value="121.5">
                    <input type="hidden" id="latitude" value="25.0">
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary" id="calculate-btn">
                            è¨ˆç®—äººé¡åœ–
                        </button>
                        <button type="button" class="btn btn-secondary" id="reset-btn">
                            é‡ç½®
                        </button>
                    </div>
                </form>
                <div id="message-area"></div>
            </div>

            <!-- çµæœé¡¯ç¤ºå€åŸŸ -->
            <div id="results-container" class="hidden">
                <div class="results-section">
                    <!-- è¡Œæ˜Ÿåˆ—è¡¨é¡¯ç¤ºå€åŸŸ -->
                    <div class="section">
                        <h2>è¡Œæ˜Ÿé–˜é–€èˆ‡çˆ»ç·š</h2>
                        <div id="body-graph-container">
                            <!-- å·¦å´æ¬„ï¼šDesignï¼ˆæ½›æ„è­˜/ç´…è‰²ï¼‰ -->
                            <div class="planet-sidebar sidebar-design" id="design-sidebar">
                                <div class="sidebar-title">æ½›æ„è­˜ (Design)</div>
                                <div id="design-planet-list">
                                    <div class="loading" style="text-align: center; padding: 20px; color: #666;">
                                        ç­‰å¾…æ•¸æ“š...
                                    </div>
                                </div>
                            </div>

                            <!-- å³å´æ¬„ï¼šPersonalityï¼ˆæ„è­˜/ç°è‰²ï¼‰ -->
                            <div class="planet-sidebar sidebar-personality" id="personality-sidebar">
                                <div class="sidebar-title">æ„è­˜ (Personality)</div>
                                <div id="personality-planet-list">
                                    <div class="loading" style="text-align: center; padding: 20px; color: #666;">
                                        ç­‰å¾…æ•¸æ“š...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- å³å´ï¼šåˆ†æçµæœ -->
                    <div class="section">
                        <h2>åˆ†æçµæœ</h2>
                        <div id="text-results-container">
                            <div class="loading">ç­‰å¾…è¨ˆç®—çµæœ...</div>
                        </div>
                    </div>
                </div>
                
                <!-- åŸºå› å¤©å‘½ (Gene Keys) é»ƒé‡‘ä¹‹è·¯å€å¡Š -->
                <div class="section" id="gene-keys-section" style="display: none; margin-top: 30px;">
                    <h2>åŸºå› å¤©å‘½ (Gene Keys) - é»ƒé‡‘ä¹‹è·¯</h2>
                    <div id="gene-keys-container">
                        <div class="loading">ç­‰å¾…è¨ˆç®—çµæœ...</div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>

    <script>
        // å°ç£ç¸£å¸‚å’Œå€åŸŸæ•¸æ“šï¼ˆåŒ…å«ç¶“ç·¯åº¦ï¼‰
        const taiwanLocations = {
            "è‡ºåŒ—å¸‚": {
                "ä¸­æ­£å€": { longitude: 121.5194, latitude: 25.0324 },
                "å¤§åŒå€": { longitude: 121.5138, latitude: 25.0626 },
                "ä¸­å±±å€": { longitude: 121.5277, latitude: 25.0642 },
                "æ¾å±±å€": { longitude: 121.5769, latitude: 25.0575 },
                "å¤§å®‰å€": { longitude: 121.5439, latitude: 25.0259 },
                "è¬è¯å€": { longitude: 121.5004, latitude: 25.0315 },
                "ä¿¡ç¾©å€": { longitude: 121.5717, latitude: 25.0330 },
                "å£«æ—å€": { longitude: 121.5267, latitude: 25.0924 },
                "åŒ—æŠ•å€": { longitude: 121.4988, latitude: 25.1327 },
                "å…§æ¹–å€": { longitude: 121.5889, latitude: 25.0696 },
                "å—æ¸¯å€": { longitude: 121.6075, latitude: 25.0543 },
                "æ–‡å±±å€": { longitude: 121.5700, latitude: 24.9891 }
            },
            "æ–°åŒ—å¸‚": {
                "æ¿æ©‹å€": { longitude: 121.4591, latitude: 25.0081 },
                "ä¸‰é‡å€": { longitude: 121.4849, latitude: 25.0621 },
                "ä¸­å’Œå€": { longitude: 121.4924, latitude: 24.9965 },
                "æ°¸å’Œå€": { longitude: 121.5136, latitude: 25.0118 },
                "æ–°èŠå€": { longitude: 121.4426, latitude: 25.0335 },
                "æ–°åº—å€": { longitude: 121.5377, latitude: 24.9564 },
                "æ¨¹æ—å€": { longitude: 121.4244, latitude: 24.9910 },
                "é¶¯æ­Œå€": { longitude: 121.3545, latitude: 24.9551 },
                "ä¸‰å³½å€": { longitude: 121.3690, latitude: 24.9341 },
                "æ·¡æ°´å€": { longitude: 121.4434, latitude: 25.1674 },
                "æ±æ­¢å€": { longitude: 121.6560, latitude: 25.0677 },
                "ç‘èŠ³å€": { longitude: 121.8056, latitude: 25.1092 },
                "åœŸåŸå€": { longitude: 121.4449, latitude: 24.9733 },
                "è˜†æ´²å€": { longitude: 121.4737, latitude: 25.0831 },
                "äº”è‚¡å€": { longitude: 121.4367, latitude: 25.0834 },
                "æ³°å±±å€": { longitude: 121.4286, latitude: 25.0576 },
                "æ—å£å€": { longitude: 121.3897, latitude: 25.0779 },
                "æ·±å‘å€": { longitude: 121.6152, latitude: 25.0019 },
                "çŸ³ç¢‡å€": { longitude: 121.6608, latitude: 24.9915 },
                "åªæ—å€": { longitude: 121.7121, latitude: 24.9371 },
                "ä¸‰èŠå€": { longitude: 121.5012, latitude: 25.2584 },
                "çŸ³é–€å€": { longitude: 121.5681, latitude: 25.2912 },
                "å…«é‡Œå€": { longitude: 121.3990, latitude: 25.1469 },
                "å¹³æºªå€": { longitude: 121.7806, latitude: 25.0256 },
                "é›™æºªå€": { longitude: 121.8657, latitude: 25.0385 },
                "è²¢å¯®å€": { longitude: 121.9225, latitude: 25.0215 },
                "é‡‘å±±å€": { longitude: 121.6384, latitude: 25.2211 },
                "è¬é‡Œå€": { longitude: 121.6895, latitude: 25.1793 },
                "çƒä¾†å€": { longitude: 121.5510, latitude: 24.8632 }
            },
            "æ¡ƒåœ’å¸‚": {
                "æ¡ƒåœ’å€": { longitude: 121.3010, latitude: 24.9936 },
                "ä¸­å£¢å€": { longitude: 121.2249, latitude: 24.9544 },
                "å¤§æºªå€": { longitude: 121.2868, latitude: 24.8844 },
                "æ¥Šæ¢…å€": { longitude: 121.1462, latitude: 24.9087 },
                "è˜†ç«¹å€": { longitude: 121.2933, latitude: 25.0479 },
                "å¤§åœ’å€": { longitude: 121.1995, latitude: 25.0649 },
                "é¾œå±±å€": { longitude: 121.3397, latitude: 25.0179 },
                "å…«å¾·å€": { longitude: 121.2840, latitude: 24.9267 },
                "é¾æ½­å€": { longitude: 121.2124, latitude: 24.8633 },
                "å¹³é®å€": { longitude: 121.2180, latitude: 24.9453 },
                "æ–°å±‹å€": { longitude: 121.0618, latitude: 24.9696 },
                "è§€éŸ³å€": { longitude: 121.0794, latitude: 25.0317 },
                "å¾©èˆˆå€": { longitude: 121.3526, latitude: 24.8182 }
            },
            "è‡ºä¸­å¸‚": {
                "ä¸­å€": { longitude: 120.6790, latitude: 24.1418 },
                "æ±å€": { longitude: 120.6972, latitude: 24.1388 },
                "å—å€": { longitude: 120.6614, latitude: 24.1261 },
                "è¥¿å€": { longitude: 120.6634, latitude: 24.1446 },
                "åŒ—å€": { longitude: 120.6792, latitude: 24.1582 },
                "è¥¿å±¯å€": { longitude: 120.6384, latitude: 24.1788 },
                "å—å±¯å€": { longitude: 120.6432, latitude: 24.1346 },
                "åŒ—å±¯å€": { longitude: 120.6976, latitude: 24.1834 },
                "è±åŸå€": { longitude: 120.7207, latitude: 24.2518 },
                "æ±å‹¢å€": { longitude: 120.8274, latitude: 24.2587 },
                "å¤§ç”²å€": { longitude: 120.6224, latitude: 24.3457 },
                "æ¸…æ°´å€": { longitude: 120.5693, latitude: 24.2686 },
                "æ²™é¹¿å€": { longitude: 120.5657, latitude: 24.2337 },
                "æ¢§æ£²å€": { longitude: 120.5306, latitude: 24.2548 },
                "åé‡Œå€": { longitude: 120.7299, latitude: 24.3095 },
                "ç¥å²¡å€": { longitude: 120.6614, latitude: 24.2568 },
                "æ½­å­å€": { longitude: 120.7050, latitude: 24.2118 },
                "å¤§é›…å€": { longitude: 120.6500, latitude: 24.2272 },
                "æ–°ç¤¾å€": { longitude: 120.8098, latitude: 24.2344 },
                "çŸ³å²¡å€": { longitude: 120.7779, latitude: 24.2746 },
                "å¤–åŸ”å€": { longitude: 120.6538, latitude: 24.3319 },
                "å¤§å®‰å€": { longitude: 120.5866, latitude: 24.3456 },
                "çƒæ—¥å€": { longitude: 120.6234, latitude: 24.1048 },
                "å¤§è‚šå€": { longitude: 120.5444, latitude: 24.1477 },
                "é¾äº•å€": { longitude: 120.5454, latitude: 24.1883 },
                "éœ§å³°å€": { longitude: 120.6986, latitude: 24.0615 },
                "å¤ªå¹³å€": { longitude: 120.7185, latitude: 24.1262 },
                "å¤§é‡Œå€": { longitude: 120.6794, latitude: 24.0989 },
                "å’Œå¹³å€": { longitude: 121.0210, latitude: 24.3103 }
            },
            "è‡ºå—å¸‚": {
                "ä¸­è¥¿å€": { longitude: 120.1960, latitude: 22.9924 },
                "æ±å€": { longitude: 120.2280, latitude: 22.9812 },
                "å—å€": { longitude: 120.1883, latitude: 22.9473 },
                "åŒ—å€": { longitude: 120.2089, latitude: 23.0103 },
                "å®‰å¹³å€": { longitude: 120.1628, latitude: 22.9872 },
                "å®‰å—å€": { longitude: 120.1587, latitude: 23.0460 },
                "æ°¸åº·å€": { longitude: 120.2579, latitude: 23.0268 },
                "æ­¸ä»å€": { longitude: 120.2938, latitude: 22.9691 },
                "æ–°åŒ–å€": { longitude: 120.3097, latitude: 23.0372 },
                "å·¦é®å€": { longitude: 120.4084, latitude: 23.0571 },
                "ç‰äº•å€": { longitude: 120.4614, latitude: 23.1233 },
                "æ¥ è¥¿å€": { longitude: 120.4844, latitude: 23.1838 },
                "å—åŒ–å€": { longitude: 120.4770, latitude: 23.0422 },
                "ä»å¾·å€": { longitude: 120.2513, latitude: 22.9696 },
                "é—œå»Ÿå€": { longitude: 120.3268, latitude: 22.9622 },
                "é¾å´å€": { longitude: 120.3605, latitude: 22.9584 },
                "å®˜ç”°å€": { longitude: 120.3164, latitude: 23.1936 },
                "éº»è±†å€": { longitude: 120.2474, latitude: 23.1814 },
                "ä½³é‡Œå€": { longitude: 120.1732, latitude: 23.1673 },
                "è¥¿æ¸¯å€": { longitude: 120.2032, latitude: 23.1229 },
                "ä¸ƒè‚¡å€": { longitude: 120.1088, latitude: 23.1342 },
                "å°‡è»å€": { longitude: 120.1272, latitude: 23.2044 },
                "å­¸ç”²å€": { longitude: 120.1802, latitude: 23.2324 },
                "åŒ—é–€å€": { longitude: 120.1251, latitude: 23.2672 },
                "æ–°ç‡Ÿå€": { longitude: 120.3159, latitude: 23.3078 },
                "å¾Œå£å€": { longitude: 120.3636, latitude: 23.3651 },
                "ç™½æ²³å€": { longitude: 120.4165, latitude: 23.3506 },
                "æ±å±±å€": { longitude: 120.4084, latitude: 23.3264 },
                "å…­ç”²å€": { longitude: 120.3714, latitude: 23.2306 },
                "ä¸‹ç‡Ÿå€": { longitude: 120.2644, latitude: 23.2331 },
                "æŸ³ç‡Ÿå€": { longitude: 120.3103, latitude: 23.2781 },
                "é¹½æ°´å€": { longitude: 120.2663, latitude: 23.3201 },
                "å–„åŒ–å€": { longitude: 120.2963, latitude: 23.1314 },
                "å¤§å…§å€": { longitude: 120.4134, latitude: 23.1194 },
                "å±±ä¸Šå€": { longitude: 120.3552, latitude: 23.1033 },
                "æ–°å¸‚å€": { longitude: 120.2952, latitude: 23.0789 },
                "å®‰å®šå€": { longitude: 120.2362, latitude: 23.1214 }
            },
            "é«˜é›„å¸‚": {
                "æ–°èˆˆå€": { longitude: 120.3094, latitude: 22.6308 },
                "å‰é‡‘å€": { longitude: 120.2924, latitude: 22.6278 },
                "è‹“é›…å€": { longitude: 120.3204, latitude: 22.6208 },
                "é¹½åŸ•å€": { longitude: 120.2844, latitude: 22.6258 },
                "é¼“å±±å€": { longitude: 120.2754, latitude: 22.6308 },
                "æ——æ´¥å€": { longitude: 120.2844, latitude: 22.6108 },
                "å‰é®å€": { longitude: 120.3174, latitude: 22.5988 },
                "ä¸‰æ°‘å€": { longitude: 120.3184, latitude: 22.6458 },
                "å·¦ç‡Ÿå€": { longitude: 120.2944, latitude: 22.6878 },
                "æ¥ æ¢“å€": { longitude: 120.3264, latitude: 22.7308 },
                "å°æ¸¯å€": { longitude: 120.3574, latitude: 22.5658 },
                "é³³å±±å€": { longitude: 120.3564, latitude: 22.6278 },
                "æ—åœ’å€": { longitude: 120.3934, latitude: 22.5088 },
                "å¤§å¯®å€": { longitude: 120.3934, latitude: 22.6058 },
                "å¤§æ¨¹å€": { longitude: 120.4324, latitude: 22.6978 },
                "å¤§ç¤¾å€": { longitude: 120.3644, latitude: 22.7278 },
                "ä»æ­¦å€": { longitude: 120.3474, latitude: 22.7018 },
                "é³¥æ¾å€": { longitude: 120.3744, latitude: 22.6608 },
                "å²¡å±±å€": { longitude: 120.2944, latitude: 22.7978 },
                "æ©‹é ­å€": { longitude: 120.3094, latitude: 22.7578 },
                "ç‡•å·¢å€": { longitude: 120.3614, latitude: 22.7938 },
                "ç”°å¯®å€": { longitude: 120.3934, latitude: 22.8678 },
                "é˜¿è“®å€": { longitude: 120.3274, latitude: 22.8778 },
                "è·¯ç«¹å€": { longitude: 120.2634, latitude: 22.8538 },
                "æ¹–å…§å€": { longitude: 120.2294, latitude: 22.9078 },
                "èŒ„è£å€": { longitude: 120.1824, latitude: 22.9078 },
                "æ°¸å®‰å€": { longitude: 120.2244, latitude: 22.8178 },
                "å½Œé™€å€": { longitude: 120.2454, latitude: 22.7838 },
                "æ¢“å®˜å€": { longitude: 120.2654, latitude: 22.7578 },
                "æ——å±±å€": { longitude: 120.4814, latitude: 22.8888 },
                "ç¾æ¿ƒå€": { longitude: 120.5474, latitude: 22.8938 },
                "å…­é¾œå€": { longitude: 120.6334, latitude: 22.9978 },
                "ç”²ä»™å€": { longitude: 120.5914, latitude: 23.0778 },
                "æ‰æ—å€": { longitude: 120.5354, latitude: 22.9578 },
                "å…§é–€å€": { longitude: 120.4714, latitude: 22.9438 },
                "èŒ‚æ—å€": { longitude: 120.6634, latitude: 22.8878 },
                "æ¡ƒæºå€": { longitude: 120.7584, latitude: 23.1878 },
                "é‚£ç‘ªå¤å€": { longitude: 120.6924, latitude: 23.2278 }
            },
            "åŸºéš†å¸‚": {
                "ä»æ„›å€": { longitude: 121.7444, latitude: 25.1278 },
                "ä¿¡ç¾©å€": { longitude: 121.7654, latitude: 25.1298 },
                "ä¸­æ­£å€": { longitude: 121.7754, latitude: 25.1388 },
                "ä¸­å±±å€": { longitude: 121.7394, latitude: 25.1488 },
                "å®‰æ¨‚å€": { longitude: 121.7244, latitude: 25.1478 },
                "æš–æš–å€": { longitude: 121.7394, latitude: 25.0988 },
                "ä¸ƒå µå€": { longitude: 121.6814, latitude: 25.0978 }
            },
            "æ–°ç«¹å¸‚": {
                "æ±å€": { longitude: 120.9754, latitude: 24.8088 },
                "åŒ—å€": { longitude: 120.9564, latitude: 24.8188 },
                "é¦™å±±å€": { longitude: 120.9244, latitude: 24.7588 }
            },
            "æ–°ç«¹ç¸£": {
                "ç«¹åŒ—å¸‚": { longitude: 120.9954, latitude: 24.8288 },
                "æ¹–å£é„‰": { longitude: 121.0444, latitude: 24.8978 },
                "æ–°è±é„‰": { longitude: 120.9844, latitude: 24.8978 },
                "æ–°åŸ”é®": { longitude: 121.0744, latitude: 24.8378 },
                "é—œè¥¿é®": { longitude: 121.1744, latitude: 24.7978 },
                "èŠæ—é„‰": { longitude: 121.0744, latitude: 24.7778 },
                "å¯¶å±±é„‰": { longitude: 120.9844, latitude: 24.7578 },
                "ç«¹æ±é®": { longitude: 121.0944, latitude: 24.7278 },
                "äº”å³°é„‰": { longitude: 121.1344, latitude: 24.6278 },
                "æ©«å±±é„‰": { longitude: 121.1544, latitude: 24.7278 },
                "å°–çŸ³é„‰": { longitude: 121.3044, latitude: 24.7078 },
                "åŒ—åŸ”é„‰": { longitude: 121.0544, latitude: 24.6978 },
                "å³¨çœ‰é„‰": { longitude: 121.0044, latitude: 24.6778 }
            },
            "è‹—æ —ç¸£": {
                "è‹—æ —å¸‚": { longitude: 120.8194, latitude: 24.5678 },
                "è‹‘è£¡é®": { longitude: 120.6544, latitude: 24.4478 },
                "é€šéœ„é®": { longitude: 120.6764, latitude: 24.4978 },
                "ç«¹å—é®": { longitude: 120.8744, latitude: 24.6878 },
                "é ­ä»½å¸‚": { longitude: 120.8944, latitude: 24.6878 },
                "å¾Œé¾é®": { longitude: 120.7864, latitude: 24.6178 },
                "å“è˜­é®": { longitude: 120.8244, latitude: 24.3078 },
                "å¤§æ¹–é„‰": { longitude: 120.8544, latitude: 24.4278 },
                "å…¬é¤¨é„‰": { longitude: 120.8244, latitude: 24.4978 },
                "éŠ…é‘¼é„‰": { longitude: 120.7844, latitude: 24.4878 },
                "å—åº„é„‰": { longitude: 121.0044, latitude: 24.5978 },
                "é ­å±‹é„‰": { longitude: 120.8444, latitude: 24.5778 },
                "ä¸‰ç¾©é„‰": { longitude: 120.7644, latitude: 24.4078 },
                "è¥¿æ¹–é„‰": { longitude: 120.7544, latitude: 24.5578 },
                "é€ æ©‹é„‰": { longitude: 120.8644, latitude: 24.6378 },
                "ä¸‰ç£é„‰": { longitude: 120.9544, latitude: 24.6478 },
                "ç…æ½­é„‰": { longitude: 120.9244, latitude: 24.5378 },
                "æ³°å®‰é„‰": { longitude: 121.0844, latitude: 24.4378 }
            },
            "å½°åŒ–ç¸£": {
                "å½°åŒ–å¸‚": { longitude: 120.5394, latitude: 24.0778 },
                "é¹¿æ¸¯é®": { longitude: 120.4344, latitude: 24.0578 },
                "å’Œç¾é®": { longitude: 120.5044, latitude: 24.1078 },
                "ç·šè¥¿é„‰": { longitude: 120.4644, latitude: 24.1278 },
                "ä¼¸æ¸¯é„‰": { longitude: 120.4844, latitude: 24.1578 },
                "ç¦èˆˆé„‰": { longitude: 120.4444, latitude: 24.0478 },
                "ç§€æ°´é„‰": { longitude: 120.5044, latitude: 24.0378 },
                "èŠ±å£‡é„‰": { longitude: 120.5444, latitude: 24.0278 },
                "èŠ¬åœ’é„‰": { longitude: 120.6244, latitude: 24.0178 },
                "å“¡æ—å¸‚": { longitude: 120.5744, latitude: 23.9578 },
                "æºªæ¹–é®": { longitude: 120.4744, latitude: 23.9578 },
                "ç”°ä¸­é®": { longitude: 120.5944, latitude: 23.8578 },
                "å¤§æ‘é„‰": { longitude: 120.5444, latitude: 23.9878 },
                "åŸ”é¹½é„‰": { longitude: 120.4644, latitude: 23.9978 },
                "åŸ”å¿ƒé„‰": { longitude: 120.5344, latitude: 23.9578 },
                "æ°¸é–é„‰": { longitude: 120.5444, latitude: 23.9278 },
                "ç¤¾é ­é„‰": { longitude: 120.5844, latitude: 23.8978 },
                "äºŒæ°´é„‰": { longitude: 120.6144, latitude: 23.8078 },
                "åŒ—æ–—é®": { longitude: 120.5244, latitude: 23.8778 },
                "äºŒæ—é®": { longitude: 120.3744, latitude: 23.8978 },
                "ç”°å°¾é„‰": { longitude: 120.5244, latitude: 23.8878 },
                "åŸ¤é ­é„‰": { longitude: 120.4644, latitude: 23.8878 },
                "èŠ³è‹‘é„‰": { longitude: 120.3244, latitude: 23.9278 },
                "å¤§åŸé„‰": { longitude: 120.3144, latitude: 23.8578 },
                "ç«¹å¡˜é„‰": { longitude: 120.4244, latitude: 23.8578 },
                "æºªå·é„‰": { longitude: 120.4944, latitude: 23.8378 }
            },
            "å—æŠ•ç¸£": {
                "å—æŠ•å¸‚": { longitude: 120.6844, latitude: 23.9078 },
                "åŸ”é‡Œé®": { longitude: 120.9644, latitude: 23.9678 },
                "è‰å±¯é®": { longitude: 120.6844, latitude: 23.9778 },
                "ç«¹å±±é®": { longitude: 120.6844, latitude: 23.7578 },
                "é›†é›†é®": { longitude: 120.7844, latitude: 23.8278 },
                "åé–“é„‰": { longitude: 120.7044, latitude: 23.8378 },
                "é¹¿è°·é„‰": { longitude: 120.7644, latitude: 23.7478 },
                "ä¸­å¯®é„‰": { longitude: 120.7644, latitude: 23.8778 },
                "é­šæ± é„‰": { longitude: 120.9244, latitude: 23.8978 },
                "åœ‹å§“é„‰": { longitude: 120.8444, latitude: 24.0278 },
                "æ°´é‡Œé„‰": { longitude: 120.8544, latitude: 23.8078 },
                "ä¿¡ç¾©é„‰": { longitude: 120.8544, latitude: 23.6978 },
                "ä»æ„›é„‰": { longitude: 121.1344, latitude: 24.0278 }
            },
            "é›²æ—ç¸£": {
                "æ–—å…­å¸‚": { longitude: 120.5444, latitude: 23.7078 },
                "æ–—å—é®": { longitude: 120.4844, latitude: 23.6778 },
                "è™å°¾é®": { longitude: 120.4344, latitude: 23.7078 },
                "è¥¿èºé®": { longitude: 120.4644, latitude: 23.7978 },
                "åœŸåº«é®": { longitude: 120.3844, latitude: 23.6778 },
                "åŒ—æ¸¯é®": { longitude: 120.3044, latitude: 23.5778 },
                "å¤å‘é„‰": { longitude: 120.5644, latitude: 23.6478 },
                "å¤§åŸ¤é„‰": { longitude: 120.4344, latitude: 23.6478 },
                "è¿æ¡é„‰": { longitude: 120.5044, latitude: 23.7578 },
                "æ—å…§é„‰": { longitude: 120.6144, latitude: 23.7578 },
                "äºŒå´™é„‰": { longitude: 120.4144, latitude: 23.7878 },
                "å´™èƒŒé„‰": { longitude: 120.3544, latitude: 23.7578 },
                "éº¥å¯®é„‰": { longitude: 120.2644, latitude: 23.7478 },
                "æ±å‹¢é„‰": { longitude: 120.2544, latitude: 23.6778 },
                "è¤’å¿ é„‰": { longitude: 120.3144, latitude: 23.6978 },
                "è‡ºè¥¿é„‰": { longitude: 120.2044, latitude: 23.7078 },
                "å…ƒé•·é„‰": { longitude: 120.3144, latitude: 23.6478 },
                "å››æ¹–é„‰": { longitude: 120.2244, latitude: 23.6378 },
                "å£æ¹–é„‰": { longitude: 120.1844, latitude: 23.5878 },
                "æ°´æ—é„‰": { longitude: 120.2444, latitude: 23.5678 }
            },
            "å˜‰ç¾©å¸‚": {
                "æ±å€": { longitude: 120.4544, latitude: 23.4878 },
                "è¥¿å€": { longitude: 120.4344, latitude: 23.4778 }
            },
            "å˜‰ç¾©ç¸£": {
                "å¤ªä¿å¸‚": { longitude: 120.3444, latitude: 23.4678 },
                "æœ´å­å¸‚": { longitude: 120.2444, latitude: 23.4678 },
                "å¸ƒè¢‹é®": { longitude: 120.1544, latitude: 23.3878 },
                "å¤§æ—é®": { longitude: 120.4544, latitude: 23.6078 },
                "æ°‘é›„é„‰": { longitude: 120.4344, latitude: 23.5578 },
                "æºªå£é„‰": { longitude: 120.3944, latitude: 23.6078 },
                "æ–°æ¸¯é„‰": { longitude: 120.3444, latitude: 23.5578 },
                "å…­è…³é„‰": { longitude: 120.2744, latitude: 23.5078 },
                "æ±çŸ³é„‰": { longitude: 120.1544, latitude: 23.4578 },
                "ç¾©ç«¹é„‰": { longitude: 120.2444, latitude: 23.3378 },
                "é¹¿è‰é„‰": { longitude: 120.3044, latitude: 23.4078 },
                "æ°´ä¸Šé„‰": { longitude: 120.3944, latitude: 23.4278 },
                "ä¸­åŸ”é„‰": { longitude: 120.5244, latitude: 23.4278 },
                "ç«¹å´é„‰": { longitude: 120.5544, latitude: 23.5078 },
                "æ¢…å±±é„‰": { longitude: 120.5644, latitude: 23.5778 },
                "ç•ªè·¯é„‰": { longitude: 120.5644, latitude: 23.4778 },
                "å¤§åŸ”é„‰": { longitude: 120.5944, latitude: 23.2978 },
                "é˜¿é‡Œå±±é„‰": { longitude: 120.7444, latitude: 23.5078 }
            },
            "å±æ±ç¸£": {
                "å±æ±å¸‚": { longitude: 120.4944, latitude: 22.6778 },
                "æ½®å·é®": { longitude: 120.5444, latitude: 22.5478 },
                "æ±æ¸¯é®": { longitude: 120.4544, latitude: 22.4678 },
                "æ†æ˜¥é®": { longitude: 120.7444, latitude: 22.0078 },
                "è¬ä¸¹é„‰": { longitude: 120.4844, latitude: 22.5878 },
                "é•·æ²»é„‰": { longitude: 120.5244, latitude: 22.6878 },
                "éºŸæ´›é„‰": { longitude: 120.5244, latitude: 22.6478 },
                "ä¹å¦‚é„‰": { longitude: 120.4944, latitude: 22.7278 },
                "é‡Œæ¸¯é„‰": { longitude: 120.4944, latitude: 22.7778 },
                "é¹½åŸ”é„‰": { longitude: 120.5644, latitude: 22.7578 },
                "é«˜æ¨¹é„‰": { longitude: 120.5944, latitude: 22.8278 },
                "è¬å·’é„‰": { longitude: 120.5644, latitude: 22.5778 },
                "å…§åŸ”é„‰": { longitude: 120.5644, latitude: 22.6178 },
                "ç«¹ç”°é„‰": { longitude: 120.5244, latitude: 22.5778 },
                "æ–°åŸ¤é„‰": { longitude: 120.5444, latitude: 22.4778 },
                "æ‹å¯®é„‰": { longitude: 120.5944, latitude: 22.3778 },
                "æ–°åœ’é„‰": { longitude: 120.4544, latitude: 22.5378 },
                "å´é ‚é„‰": { longitude: 120.5144, latitude: 22.5078 },
                "æ—é‚Šé„‰": { longitude: 120.5144, latitude: 22.4378 },
                "å—å·é„‰": { longitude: 120.5144, latitude: 22.4878 },
                "ä½³å†¬é„‰": { longitude: 120.5444, latitude: 22.4178 },
                "ç‰çƒé„‰": { longitude: 120.3744, latitude: 22.3478 },
                "è»ŠåŸé„‰": { longitude: 120.7144, latitude: 22.0678 },
                "æ»¿å·é„‰": { longitude: 120.8144, latitude: 22.0278 },
                "æ‹å±±é„‰": { longitude: 120.6544, latitude: 22.2578 },
                "ä¸‰åœ°é–€é„‰": { longitude: 120.6544, latitude: 22.7178 },
                "éœ§å°é„‰": { longitude: 120.7344, latitude: 22.7478 },
                "ç‘ªå®¶é„‰": { longitude: 120.6544, latitude: 22.6478 },
                "æ³°æ­¦é„‰": { longitude: 120.6344, latitude: 22.5878 },
                "ä¾†ç¾©é„‰": { longitude: 120.6744, latitude: 22.5278 },
                "æ˜¥æ—¥é„‰": { longitude: 120.6244, latitude: 22.3778 },
                "ç…å­é„‰": { longitude: 120.7044, latitude: 22.2078 },
                "ç‰¡ä¸¹é„‰": { longitude: 120.7944, latitude: 22.1278 }
            },
            "å®œè˜­ç¸£": {
                "å®œè˜­å¸‚": { longitude: 121.7544, latitude: 24.7578 },
                "ç¾…æ±é®": { longitude: 121.7744, latitude: 24.6778 },
                "è˜‡æ¾³é®": { longitude: 121.8544, latitude: 24.5978 },
                "é ­åŸé®": { longitude: 121.8244, latitude: 24.8578 },
                "ç¤æºªé„‰": { longitude: 121.7744, latitude: 24.8278 },
                "å£¯åœé„‰": { longitude: 121.8044, latitude: 24.7578 },
                "å“¡å±±é„‰": { longitude: 121.7344, latitude: 24.7478 },
                "å†¬å±±é„‰": { longitude: 121.7944, latitude: 24.6378 },
                "äº”çµé„‰": { longitude: 121.8044, latitude: 24.6878 },
                "ä¸‰æ˜Ÿé„‰": { longitude: 121.6644, latitude: 24.6678 },
                "å¤§åŒé„‰": { longitude: 121.6044, latitude: 24.5778 },
                "å—æ¾³é„‰": { longitude: 121.7944, latitude: 24.4578 }
            },
            "èŠ±è“®ç¸£": {
                "èŠ±è“®å¸‚": { longitude: 121.6044, latitude: 23.9778 },
                "é³³æ—é®": { longitude: 121.4544, latitude: 23.7478 },
                "ç‰é‡Œé®": { longitude: 121.3144, latitude: 23.3378 },
                "æ–°åŸé„‰": { longitude: 121.6544, latitude: 24.0278 },
                "å‰å®‰é„‰": { longitude: 121.5744, latitude: 23.9578 },
                "å£½è±é„‰": { longitude: 121.5144, latitude: 23.8678 },
                "å…‰å¾©é„‰": { longitude: 121.4244, latitude: 23.6578 },
                "è±æ¿±é„‰": { longitude: 121.5144, latitude: 23.5978 },
                "ç‘ç©—é„‰": { longitude: 121.3744, latitude: 23.4978 },
                "å¯Œé‡Œé„‰": { longitude: 121.2544, latitude: 23.1778 },
                "ç§€æ—é„‰": { longitude: 121.6044, latitude: 24.1278 },
                "è¬æ¦®é„‰": { longitude: 121.4044, latitude: 23.7078 },
                "å“æºªé„‰": { longitude: 121.3044, latitude: 23.3478 }
            },
            "è‡ºæ±ç¸£": {
                "è‡ºæ±å¸‚": { longitude: 121.1444, latitude: 22.7578 },
                "æˆåŠŸé®": { longitude: 121.3744, latitude: 23.1078 },
                "é—œå±±é®": { longitude: 121.1644, latitude: 23.0478 },
                "å‘å—é„‰": { longitude: 121.0844, latitude: 22.7878 },
                "é¹¿é‡é„‰": { longitude: 121.1344, latitude: 22.9178 },
                "æ± ä¸Šé„‰": { longitude: 121.2144, latitude: 23.1278 },
                "æ±æ²³é„‰": { longitude: 121.3044, latitude: 22.9678 },
                "é•·æ¿±é„‰": { longitude: 121.4544, latitude: 23.3278 },
                "å¤ªéº»é‡Œé„‰": { longitude: 121.0044, latitude: 22.6078 },
                "å¤§æ­¦é„‰": { longitude: 120.8944, latitude: 22.3578 },
                "ç¶ å³¶é„‰": { longitude: 121.4744, latitude: 22.6578 },
                "æµ·ç«¯é„‰": { longitude: 121.1744, latitude: 23.1978 },
                "å»¶å¹³é„‰": { longitude: 121.0744, latitude: 22.8978 },
                "é‡‘å³°é„‰": { longitude: 120.8944, latitude: 22.5978 },
                "é”ä»é„‰": { longitude: 120.8844, latitude: 22.2978 },
                "è˜­å¶¼é„‰": { longitude: 121.5544, latitude: 22.0578 }
            },
            "æ¾æ¹–ç¸£": {
                "é¦¬å…¬å¸‚": { longitude: 119.5644, latitude: 23.5678 },
                "æ¹–è¥¿é„‰": { longitude: 119.6544, latitude: 23.5778 },
                "ç™½æ²™é„‰": { longitude: 119.5844, latitude: 23.6578 },
                "è¥¿å¶¼é„‰": { longitude: 119.5044, latitude: 23.5978 },
                "æœ›å®‰é„‰": { longitude: 119.5044, latitude: 23.3578 },
                "ä¸ƒç¾é„‰": { longitude: 119.4244, latitude: 23.2078 }
            },
            "é‡‘é–€ç¸£": {
                "é‡‘åŸé®": { longitude: 118.3244, latitude: 24.4378 },
                "é‡‘æ¹–é®": { longitude: 118.4044, latitude: 24.4478 },
                "é‡‘æ²™é®": { longitude: 118.4044, latitude: 24.4978 },
                "é‡‘å¯§é„‰": { longitude: 118.3244, latitude: 24.4578 },
                "çƒˆå¶¼é„‰": { longitude: 118.2344, latitude: 24.4278 },
                "çƒåµé„‰": { longitude: 119.4544, latitude: 24.9878 }
            },
            "é€£æ±Ÿç¸£": {
                "å—ç«¿é„‰": { longitude: 119.9444, latitude: 26.1478 },
                "åŒ—ç«¿é„‰": { longitude: 119.9844, latitude: 26.2278 },
                "è’å…‰é„‰": { longitude: 119.9344, latitude: 25.9678 },
                "æ±å¼•é„‰": { longitude: 120.4944, latitude: 26.3678 }
            }
        };

        // åˆå§‹åŒ–ç¸£å¸‚é¸å–®
        function initializeCountySelect() {
            const countySelect = document.getElementById('county');
            const districtSelect = document.getElementById('district');
            
            if (!countySelect || !districtSelect) {
                console.error('æ‰¾ä¸åˆ°ç¸£å¸‚æˆ–å€åŸŸé¸å–®å…ƒç´ ');
                return;
            }
            
            // æ¸…ç©ºé¸å–®
            countySelect.innerHTML = '<option value="">è«‹é¸æ“‡ç¸£å¸‚</option>';
            districtSelect.innerHTML = '<option value="">è«‹å…ˆé¸æ“‡ç¸£å¸‚</option>';
            
            // å¡«å……ç¸£å¸‚é¸å–®
            let countyCount = 0;
            for (const county in taiwanLocations) {
                const option = document.createElement('option');
                option.value = county;
                option.textContent = county;
                countySelect.appendChild(option);
                countyCount++;
            }
            
            console.log('ç¸£å¸‚é¸å–®å·²åˆå§‹åŒ–ï¼Œå…± ' + countyCount + ' å€‹ç¸£å¸‚');
            console.log('taiwanLocations æ•¸æ“š:', Object.keys(taiwanLocations));
        }

        // ç•¶é¸æ“‡ç¸£å¸‚æ™‚ï¼Œæ›´æ–°å€åŸŸé¸å–®
        function updateDistrictSelect(county) {
            const districtSelect = document.getElementById('district');
            districtSelect.innerHTML = '<option value="">è«‹é¸æ“‡å€åŸŸ/é„‰é®</option>';
            
            if (county && taiwanLocations[county]) {
                for (const district in taiwanLocations[county]) {
                    const option = document.createElement('option');
                    option.value = district;
                    option.textContent = district;
                    districtSelect.appendChild(option);
                }
            }
        }

        // ç•¶é¸æ“‡å€åŸŸæ™‚ï¼Œæ›´æ–°ç¶“ç·¯åº¦
        function updateCoordinates(county, district) {
            const longitudeInput = document.getElementById('longitude');
            const latitudeInput = document.getElementById('latitude');
            
            if (!longitudeInput || !latitudeInput) {
                console.error('æ‰¾ä¸åˆ°ç¶“ç·¯åº¦è¼¸å…¥æ¬„ä½');
                return;
            }
            
            if (county && district && taiwanLocations[county] && taiwanLocations[county][district]) {
                const location = taiwanLocations[county][district];
                longitudeInput.value = location.longitude.toFixed(4);
                latitudeInput.value = location.latitude.toFixed(4);
                
                console.log('å·²æ›´æ–°ç¶“ç·¯åº¦:', {
                    county: county,
                    district: district,
                    longitude: longitudeInput.value,
                    latitude: latitudeInput.value
                });
            } else {
                console.warn('ç„¡æ³•æ›´æ–°ç¶“ç·¯åº¦:', { county, district, 
                    hasCounty: !!county, 
                    hasDistrict: !!district,
                    hasLocationData: !!(county && taiwanLocations[county]),
                    hasDistrictData: !!(county && district && taiwanLocations[county] && taiwanLocations[county][district])
                });
            }
        }

        // ä¸­å¿ƒåç¨±æ˜ å°„
        const centerNameMap = {
            "Head": "head",
            "Ajna": "ajna",
            "Throat": "throat",
            "G": "g",
            "Ego": "ego",
            "Spleen": "spleen",
            "Sacral": "sacral",
            "Solar_Plexus": "solar-plexus",
            "Root": "root"
        };

        // é€šé“ ID æ˜ å°„å‡½æ•¸
        function getChannelId(gate1, gate2) {
            return `channel-${gate1}-${gate2}`;
        }

        // æ¸²æŸ“äººé¡åœ–çš„ä¸»è¦å‡½å¼
        function renderHumanDesign(data) {
            if (!data) {
                console.error("ç„¡æ•ˆçš„æ•¸æ“šæ ¼å¼");
                return;
            }

            // 1. æ¸²æŸ“æ–‡å­—çµæœ
            renderTextResults(data);

            // 2. æ¸²æŸ“è¡Œæ˜Ÿåˆ—è¡¨ï¼ˆå¦‚æœæ•¸æ“šåŒ…å«ï¼‰
            // æ³¨æ„ï¼šåƒæ•¸é †åºç‚º (personalityList, designList)
            // design_list é¡¯ç¤ºåœ¨å·¦å´ï¼Œpersonality_list é¡¯ç¤ºåœ¨å³å´
            if (data.design_list && data.personality_list) {
                renderPlanetLists(data.personality_list, data.design_list);
            } else {
                // å¦‚æœæ²’æœ‰æ•¸æ“šï¼Œé¡¯ç¤ºæç¤ºä¿¡æ¯
                const designContainer = document.getElementById('design-planet-list');
                const personalityContainer = document.getElementById('personality-planet-list');
                if (designContainer) {
                    designContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æ•¸æ“šæœªæä¾›</div>';
                }
                if (personalityContainer) {
                    personalityContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æ•¸æ“šæœªæä¾›</div>';
                }
            }
            
            // 3. æ¸²æŸ“åŸºå› å¤©å‘½ (Gene Keys)
            if (data.design_list && data.personality_list) {
                renderGeneKeys(data.personality_list, data.design_list);
            }
            
        }
        // æ¸²æŸ“åŸºå› å¤©å‘½ (Gene Keys) é»ƒé‡‘ä¹‹è·¯ - é‡æ§‹ç‰ˆæœ¬
        function renderGeneKeys(personalityList, designList) {
            const container = document.getElementById('gene-keys-container');
            const section = document.getElementById('gene-keys-section');
            
            if (!container || !section) {
                console.error('æ‰¾ä¸åˆ°åŸºå› å¤©å‘½å®¹å™¨');
                return;
            }
            
            // å¾è¡Œæ˜Ÿåˆ—è¡¨ä¸­æå–é—œéµæ•¸æ“š
            function findPlanet(list, planetName) {
                return list.find(p => p.planet === planetName);
            }
            
            // ç²å–é—œéµè¡Œæ˜Ÿæ•¸æ“š
            const personalitySun = findPlanet(personalityList, 'Sun');
            const personalityEarth = findPlanet(personalityList, 'Earth');
            const designSun = findPlanet(designList, 'Sun');
            const designEarth = findPlanet(designList, 'Earth');
            const personalityMoon = findPlanet(personalityList, 'Moon');
            const designMoon = findPlanet(designList, 'Moon');
            const personalityVenus = findPlanet(personalityList, 'Venus');
            const designVenus = findPlanet(designList, 'Venus');
            const personalityMars = findPlanet(personalityList, 'Mars');
            const designMars = findPlanet(designList, 'Mars');
            const personalityJupiter = findPlanet(personalityList, 'Jupiter');
            const designJupiter = findPlanet(designList, 'Jupiter');
            
            // åŸºå› å¤©å‘½ç¯€é»å®šç¾©ï¼ˆ5x5 ç¶²æ ¼ç³»çµ±ï¼‰
            // æ ¼å¼: { id, label, value, color, gridRow, gridCol, description }
            const geneKeyNodes = [
                // å‚ç›´ä¸­è»¸ (ç¬¬ 3 æ¬„)
                { id: 'personality-sun', label: 'é»‘å¤ªé™½', value: personalitySun?.gate_line || 'N/A', 
                  color: 'green', gridRow: 1, gridCol: 3, description: 'Life\'s Work', planet: 'Sun', type: 'personality' },
                { id: 'personality-jupiter', label: 'é»‘æœ¨æ˜Ÿ', value: personalityJupiter?.gate_line || 'N/A', 
                  color: 'blue', gridRow: 2, gridCol: 3, description: 'Pearl', planet: 'Jupiter', type: 'personality' },
                { id: 'design-venus', label: 'ç´…é‡‘æ˜Ÿ', value: designVenus?.gate_line || 'N/A', 
                  color: 'orange', gridRow: 3, gridCol: 3, description: 'SQ', planet: 'Venus', type: 'design' },
                { id: 'design-moon', label: 'ç´…æœˆäº®', value: designMoon?.gate_line || 'N/A', 
                  color: 'orange', gridRow: 4, gridCol: 3, description: 'Attraction', planet: 'Moon', type: 'design' },
                { id: 'design-earth', label: 'ç´…åœ°çƒ', value: designEarth?.gate_line || 'N/A', 
                  color: 'green', gridRow: 5, gridCol: 3, description: 'Purpose', planet: 'Earth', type: 'design' },
                
                // ä¸­å±¤å…©å´ (ç¬¬ 2, 4 æ¬„)
                { id: 'design-mars', label: 'ç´…ç«æ˜Ÿ', value: designMars?.gate_line || 'N/A', 
                  color: 'blue', gridRow: 2, gridCol: 2, description: 'Core', planet: 'Mars', type: 'design', transform: 'translate(20px, 60px)' },
                { id: 'design-jupiter', label: 'ç´…æœ¨æ˜Ÿ', value: designJupiter?.gate_line || 'N/A', 
                  color: 'blue', gridRow: 2, gridCol: 4, description: 'Culture', planet: 'Jupiter', type: 'design', transform: 'translate(-20px, 60px)' },
                { id: 'design-sun', label: 'ç´…å¤ªé™½', value: designSun?.gate_line || 'N/A', 
                  color: 'green', gridRow: 3, gridCol: 1, description: 'Radiance', planet: 'Sun', type: 'design' },
                { id: 'personality-earth', label: 'é»‘åœ°çƒ', value: personalityEarth?.gate_line || 'N/A', 
                  color: 'green', gridRow: 3, gridCol: 5, description: 'Evolution', planet: 'Earth', type: 'personality' },
                { id: 'personality-venus', label: 'é»‘é‡‘æ˜Ÿ', value: personalityVenus?.gate_line || 'N/A', 
                  color: 'orange', gridRow: 4, gridCol: 2, description: 'IQ', planet: 'Venus', type: 'personality', transform: 'translate(0, -70px)' },
                { id: 'personality-mars', label: 'é»‘ç«æ˜Ÿ', value: personalityMars?.gate_line || 'N/A', 
                  color: 'orange', gridRow: 4, gridCol: 4, description: 'EQ', planet: 'Mars', type: 'personality', transform: 'translate(0, -70px)' },
            ];
            
            // æ§‹å»ºé€£æ¥ç·šæ•¸æ“šï¼ˆæ ¹æ“šæŒ‡å®šçš„ä¸‰æ¢åºåˆ—è·¯å¾‘ï¼‰
            const connections = [
                // 1. å•Ÿå‹•åºåˆ— (Activation Sequence) - ç¶ è‰²é€£ç·š
                { from: 'design-sun', to: 'design-earth', color: 'green' },        // ç´…å¤ªé™½ â†’ ç´…åœ°çƒ
                { from: 'personality-sun', to: 'personality-earth', color: 'green' }, // é»‘å¤ªé™½ â†’ é»‘åœ°çƒ
                { from: 'personality-earth', to: 'design-sun', color: 'green' },   // é»‘åœ°çƒ â†’ ç´…å¤ªé™½
                { from: 'design-sun', to: 'personality-earth', color: 'green' },   // ç´…å¤ªé™½ â†’ é»‘åœ°çƒ
                { from: 'personality-earth', to: 'design-earth', color: 'green' }, // é»‘åœ°çƒ â†’ ç´…åœ°çƒ
                { from: 'design-earth', to: 'personality-earth', color: 'green' }, // ç´…åœ°çƒ â†’ é»‘åœ°çƒ
                
                // 2. é‡‘æ˜Ÿåºåˆ— (Venus Sequence) - ç´…è‰²é€£ç·š
                { from: 'personality-venus', to: 'personality-mars', color: 'red' }, // é»‘é‡‘æ˜Ÿ â†’ é»‘ç«æ˜Ÿ
                { from: 'personality-venus', to: 'design-moon', color: 'red' },      // é»‘é‡‘æ˜Ÿ â†’ ç´…æœˆäº®
                { from: 'design-moon', to: 'design-earth', color: 'red' },          // ç´…æœˆäº® â†’ ç´…åœ°çƒ
                { from: 'design-earth', to: 'design-moon', color: 'red' },          // ç´…åœ°çƒ â†’ ç´…æœˆäº®
                { from: 'design-venus', to: 'personality-mars', color: 'red' },    // ç´…é‡‘æ˜Ÿ â†’ é»‘ç«æ˜Ÿ
                
                // 3. çç åºåˆ— (Pearl Sequence) - è—è‰²é€£ç·š
                { from: 'design-venus', to: 'design-jupiter', color: 'blue' },     // ç´…é‡‘æ˜Ÿ â†’ ç´…æœ¨æ˜Ÿ
                { from: 'design-jupiter', to: 'personality-jupiter', color: 'blue' }, // ç´…æœ¨æ˜Ÿ â†’ é»‘æœ¨æ˜Ÿ
                { from: 'personality-jupiter', to: 'design-mars', color: 'blue' }, // é»‘æœ¨æ˜Ÿ â†’ ç´…ç«æ˜Ÿ
                { from: 'design-mars', to: 'design-venus', color: 'blue' },        // ç´…ç«æ˜Ÿ â†’ ç´…é‡‘æ˜Ÿ
                { from: 'design-mars', to: 'design-jupiter', color: 'blue' },      // ç´…ç«æ˜Ÿ â†’ ç´…æœ¨æ˜Ÿ
                { from: 'personality-sun', to: 'design-mars', color: 'blue' },     // é»‘å¤ªé™½ â†’ ç´…ç«æ˜Ÿ
                { from: 'personality-sun', to: 'design-jupiter', color: 'blue' },  // é»‘å¤ªé™½ â†’ ç´…æœ¨æ˜Ÿ
                { from: 'personality-jupiter', to: 'personality-sun', color: 'blue' }, // é»‘æœ¨æ˜Ÿ â†’ é»‘å¤ªé™½
            ];
            
            // å‰µå»ºå®¹å™¨ï¼ˆä½¿ç”¨ 5x5 ç¶²æ ¼ï¼‰
            const wrapper = document.createElement('div');
            wrapper.className = 'gene-keys-wrapper';
            
            // å‰µå»º SVG å±¤ï¼ˆæœ€åº•å±¤ï¼‰
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.setAttribute('class', 'gene-keys-svg');
            svg.setAttribute('width', '900');
            svg.setAttribute('height', '900');
            svg.setAttribute('viewBox', '0 0 900 900');
            
            // è¨ˆç®—æ¯å€‹ç¶²æ ¼å–®å…ƒçš„ä¸­å¿ƒé»ï¼ˆè€ƒæ…® gap å’Œ paddingï¼‰
            // ç¸½å°ºå¯¸: 900px, padding: 60px (å…©é‚Š), gap: 100px (4å€‹)
            // å–®å…ƒæ ¼å¯¬åº¦ = (900 - 2*60 - 4*100) / 5 = 76px
            const getCenterPoint = (gridRow, gridCol) => {
                const padding = 60;
                const gap = 100;
                const cellSize = (900 - 2 * padding - 4 * gap) / 5; // 76px
                
                // è¨ˆç®—ä¸­å¿ƒé»ï¼špadding + (col-1)*(cell+gap) + cell/2
                const x = padding + (gridCol - 1) * (cellSize + gap) + cellSize / 2;
                const y = padding + (gridRow - 1) * (cellSize + gap) + cellSize / 2;
                
                return { x, y };
            };
            
            // å‰µå»ºç¯€é»ä¸¦è¨˜éŒ„ä½ç½®
            const nodePositions = {};
            
            geneKeyNodes.forEach(node => {
                // å‰µå»ºç¯€é»å…ƒç´ 
                const nodeEl = document.createElement('div');
                nodeEl.className = `gene-key-sphere ${node.color}`;
                nodeEl.id = `gene-key-${node.id}`;
                
                // è¨­ç½®ç¶²æ ¼ä½ç½®
                nodeEl.style.gridRow = node.gridRow;
                nodeEl.style.gridColumn = node.gridCol;
                
                // å¦‚æœæœ‰ transform å±¬æ€§ï¼Œæ‡‰ç”¨å®ƒ
                if (node.transform) {
                    nodeEl.setAttribute('data-transform', node.transform);
                    nodeEl.style.transform = node.transform;
                    // ç‚ºäº† hover æ•ˆæœï¼Œä½¿ç”¨ CSS è®Šé‡ä¿å­˜åŸå§‹ transform
                    nodeEl.style.setProperty('--original-transform', node.transform + ' scale(1.15)');
                }
                
                // è§£æé–˜é–€å’Œçˆ»ç·š
                const gateLine = node.value.toString();
                const parts = gateLine.split('.');
                const gate = parts[0] || '';
                const line = parts[1] || '';
                
                // ç²å–æ˜Ÿåº§ç¬¦è™Ÿï¼ˆå¾åŸå§‹è¡Œæ˜Ÿæ•¸æ“šï¼‰
                let zodiac = '';
                const planetData = findPlanet(node.type === 'personality' ? personalityList : designList, node.planet);
                if (planetData && planetData.constellation_symbol) {
                    zodiac = planetData.constellation_symbol;
                }
                
                // ä½¿ç”¨èˆ‡åœ“å½¢åœ–è¡¨ç›¸åŒçš„æ ¼å¼é¡¯ç¤º
                nodeEl.innerHTML = `
                    <div class="planet-marker-name">${node.label}</div>
                    <div class="planet-marker-house"></div>
                    <div class="planet-marker-gate">${gate}</div>
                    <div class="planet-marker-line">${line}çˆ»</div>
                    <div class="planet-marker-zodiac">${zodiac}</div>
                `;
                
                wrapper.appendChild(nodeEl);
                
                // è¨˜éŒ„ç¯€é»ä¸­å¿ƒä½ç½®
                const center = getCenterPoint(node.gridRow, node.gridCol);
                nodePositions[node.id] = center;
            });
            
            // è¼”åŠ©å‡½æ•¸ï¼šç²å–é€£æ¥ç·šé¡è‰²
            function getConnectionColor(colorType) {
                switch(colorType) {
                    case 'blue': return '#3498db';  // çç åºåˆ— - è—è‰²
                    case 'green': return '#76a07b';  // å•Ÿå‹•åºåˆ— - ç¶ è‰²ï¼ˆèˆ‡çƒé«”é¡è‰²ä¸€è‡´ï¼‰
                    case 'red': return '#c0392b';    // é‡‘æ˜Ÿåºåˆ— - ç´…è‰²
                    default: return '#999';
                }
            }
            
            // ç¹ªè£½ SVG é€£æ¥ç·šçš„å‡½æ•¸
            function drawGeneKeyLines() {
                // æ¸…é™¤ä¹‹å‰çš„é€£ç·š
                svg.innerHTML = '';
                
                // ç²å– containerWrapper å…ƒç´ ï¼ˆé€šéæŸ¥æ‰¾åŒ…å« SVG çš„çˆ¶å…ƒç´ ï¼‰
                const svgParent = svg.parentElement;
                if (!svgParent) {
                    console.warn('æ‰¾ä¸åˆ° SVG çš„çˆ¶å…ƒç´ ');
                    return;
                }
                
                const containerWrapperRect = svgParent.getBoundingClientRect();
                
                // é‡æ–°è¨ˆç®—æ‰€æœ‰ç¯€é»çš„å¯¦éš›ä¸­å¿ƒä½ç½®ï¼ˆåŸºæ–¼ DOM å…ƒç´ ï¼‰
                const actualPositions = {};
                geneKeyNodes.forEach(node => {
                    const nodeEl = document.getElementById(`gene-key-${node.id}`);
                    if (nodeEl && svgParent) {
                        const nodeRect = nodeEl.getBoundingClientRect();
                        // è¨ˆç®—ç›¸å°æ–¼ SVG çš„åº§æ¨™ï¼ˆçƒé«”åœ“å¿ƒï¼‰
                        // SVG æ˜¯çµ•å°å®šä½åœ¨ containerWrapper å…§çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ containerWrapper ä½œç‚ºåƒè€ƒ
                        actualPositions[node.id] = {
                            x: nodeRect.left - containerWrapperRect.left + nodeRect.width / 2,
                            y: nodeRect.top - containerWrapperRect.top + nodeRect.height / 2
                        };
                    } else {
                        // å¦‚æœ DOM é‚„æ²’æ¸²æŸ“ï¼Œä½¿ç”¨è¨ˆç®—çš„åº§æ¨™
                        actualPositions[node.id] = nodePositions[node.id];
                    }
                });
                
                // ç¹ªè£½ SVG é€£æ¥ç·šï¼ˆä½¿ç”¨ path å…ƒç´ ï¼‰
                connections.forEach(conn => {
                    const fromPos = actualPositions[conn.from] || nodePositions[conn.from];
                    const toPos = actualPositions[conn.to] || nodePositions[conn.to];
                    
                    if (!fromPos || !toPos) {
                        console.warn(`æ‰¾ä¸åˆ°ç¯€é»ä½ç½®: ${conn.from} -> ${conn.to}`);
                        return;
                    }
                    
                    // å‰µå»º SVG path å…ƒç´ 
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    
                    // ä½¿ç”¨ç°¡å–®çš„ç›´ç·šé€£æ¥çƒé«”åœ“å¿ƒ
                    const d = `M ${fromPos.x} ${fromPos.y} L ${toPos.x} ${toPos.y}`;
                    path.setAttribute('d', d);
                    path.setAttribute('class', `gene-key-path gene-key-path-${conn.color}`);
                    path.setAttribute('stroke', getConnectionColor(conn.color));
                    path.setAttribute('stroke-width', '4');
                    path.setAttribute('stroke-opacity', '0.5');
                    path.setAttribute('fill', 'none');
                    
                    svg.appendChild(path);
                });
                
                console.log('å·²ç¹ªè£½', connections.length, 'æ¢é€£æ¥ç·š');
            }
            
            // å°‡ SVG å’Œ wrapper æ”¾å…¥å®¹å™¨
            const containerWrapper = document.createElement('div');
            containerWrapper.style.position = 'relative';
            containerWrapper.style.width = '900px';
            containerWrapper.style.height = '900px';
            containerWrapper.style.margin = '-20px auto 0 -30px';
            
            // å…ˆæ·»åŠ  SVGï¼ˆåº•å±¤ï¼‰
            containerWrapper.appendChild(svg);
            // å†æ·»åŠ  wrapperï¼ˆä¸Šå±¤ï¼‰
            containerWrapper.appendChild(wrapper);
            
            container.innerHTML = '';
            container.appendChild(containerWrapper);
            section.style.display = 'block';
            
            // åœ¨æ‰€æœ‰ç¯€é»æ¸²æŸ“å®Œæˆå¾Œç¹ªè£½é€£ç·šï¼ˆå»¶é²æ›´é•·ä»¥ç¢ºä¿ DOM å®Œå…¨æ¸²æŸ“ï¼‰
            setTimeout(() => {
                drawGeneKeyLines();
            }, 200);
        }

        // æ¸²æŸ“æ–‡å­—çµæœ
        function renderTextResults(data) {
            const container = document.getElementById('text-results-container');
            
            let typeClass = 'type-generator';
            if (data.type) {
                if (data.type.includes('é¡¯ç¤ºå‹ç”Ÿç”¢è€…') || data.type.includes('Manifesting Generator')) {
                    typeClass = 'type-manifestor';  // ä½¿ç”¨ç›¸åŒçš„æ¨£å¼
                } else if (data.type.includes('é¡¯ç¤ºè€…') || data.type.includes('Manifestor')) {
                typeClass = 'type-manifestor';
                } else if (data.type.includes('æŠ•å°„è€…') || data.type.includes('Projector')) {
                typeClass = 'type-projector';
                } else if (data.type.includes('åæ˜ è€…') || data.type.includes('Reflector')) {
                typeClass = 'type-reflector';
                }
            }

            let html = `
                <div class="info-box">
                    <h3>è¼¸å…¥æ•¸æ“š</h3>
                    <p><strong>æ—¥æœŸæ™‚é–“ï¼š</strong>${data.input_date || 'N/A'}</p>
                </div>

                <div class="info-box highlight-box">
                    <h3>äººç”Ÿè§’è‰² (Profile)</h3>
                    <div class="profile-badge">${data.profile || 'N/A'}</div>
                </div>

                <div class="info-box">
                    <h3>äººé¡åœ–é¡å‹</h3>
                    <div class="type-badge ${typeClass}">${data.type || 'N/A'}</div>
                </div>

                <div class="info-box">
                    <h3>äººç”Ÿç­–ç•¥</h3>
                    <p class="strategy-text">${data.strategy || 'N/A'}</p>
                </div>

                <div class="info-box">
                    <h3>æ±ºç­–æ¨¡å¼</h3>
                    <p class="definition-text">${data.decision_mode || 'N/A'}</p>
                </div>

                <div class="info-box">
                    <h3>å…§åœ¨æ¬Šå¨</h3>
                    <p class="authority-text">${data.inner_authority || 'N/A'}</p>
                </div>

                <div class="info-box warning-box">
                    <h3>éè‡ªå·±ä¸»é¡Œ</h3>
                    <p class="theme-text">${data.not_self_theme || 'N/A'}</p>
                </div>
            `;

            if (data.defined_channels && data.defined_channels.length > 0) {
                html += `
                    <div class="info-box" style="margin-top: 20px;">
                        <h3>å®šç¾©çš„é€šé“</h3>
                        <p>å…± ${data.defined_channels.length} æ¢é€šé“è¢«å®šç¾©</p>
                        <p style="margin-top: 10px;">
                            ${data.defined_channels.map(ch => `é€šé“ ${ch[0]}-${ch[1]}`).join(', ')}
                        </p>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // æ¸²æŸ“è¡Œæ˜Ÿåˆ—è¡¨åˆ°å´é‚Šæ¬„
        function renderPlanetLists(personalityList, designList) {
            // è¡Œæ˜Ÿ Unicode åœ–æ¨™æ˜ å°„
            const planetIcons = {
                'Sun': 'â˜‰',
                'Earth': 'âŠ•',
                'Moon': 'â˜½',
                'North Node': 'â˜Š',
                'South Node': 'â˜‹',
                'Mercury': 'â˜¿',
                'Venus': 'â™€',
                'Mars': 'â™‚',
                'Jupiter': 'â™ƒ',
                'Saturn': 'â™„',
                'Uranus': 'â™…',
                'Neptune': 'â™†',
                'Pluto': 'â™‡'
            };
            
            // è¡Œæ˜Ÿåç¨±ä¸­æ–‡æ˜ å°„ï¼ˆä¿ç•™ä½œç‚ºå‚™ç”¨ï¼‰
            const planetNames = {
                'Sun': 'å¤ªé™½',
                'Earth': 'åœ°çƒ',
                'Moon': 'æœˆäº®',
                'North Node': 'åŒ—äº¤',
                'South Node': 'å—äº¤',
                'Mercury': 'æ°´æ˜Ÿ',
                'Venus': 'é‡‘æ˜Ÿ',
                'Mars': 'ç«æ˜Ÿ',
                'Jupiter': 'æœ¨æ˜Ÿ',
                'Saturn': 'åœŸæ˜Ÿ',
                'Uranus': 'å¤©ç‹æ˜Ÿ',
                'Neptune': 'æµ·ç‹æ˜Ÿ',
                'Pluto': 'å†¥ç‹æ˜Ÿ'
            };

            // è¼”åŠ©å‡½æ•¸ï¼šæ ¼å¼åŒ–é–˜é–€.çˆ»ç·šé¡¯ç¤ºï¼ˆåˆ†é–‹é¡¯ç¤ºï¼Œçˆ»ç·šè¼ƒå°ï¼Œä¸¦åŒ…å«æ˜Ÿåº§ç¬¦è™Ÿå’Œç®­é ­ï¼‰
            function formatGateLine(planet, showArrow = true) {
                if (!planet.gate_line) return '';
                const parts = planet.gate_line.toString().split('.');
                if (parts.length === 2) {
                    const gate = parts[0];
                    const line = parts[1];
                    const zodiac = planet.constellation_symbol || '';
                    const arrow = (showArrow && planet.arrow_direction) || '';
                    
                    // ç®­é ­é¡è‰²ï¼šâ–²ç¶ è‰²ï¼Œâ–¼ç´…è‰²
                    let arrowHtml = '';
                    if (arrow === 'â–²') {
                        arrowHtml = `<span class="arrow-ascending" title="é †è¡Œé«˜é »">â–²</span>`;
                    } else if (arrow === 'â–¼') {
                        arrowHtml = `<span class="arrow-descending" title="é€†è¡Œ">â–¼</span>`;
                    }
                    
                    return `
                        ${zodiac ? `<span class="zodiac-symbol">${zodiac}</span>` : ''}
                        <span class="gate-number">${gate}</span>
                        <span class="gate-separator">.</span>
                        <span class="line-number">${line}</span>
                        ${arrowHtml}
                    `;
                }
                // å¦‚æœæ ¼å¼ä¸æ­£ç¢ºï¼Œè¿”å›åŸå§‹å€¼
                return `<span class="gate-number">${planet.gate_line}</span>`;
            }

            // æ¸²æŸ“è¨­è¨ˆå±¤ï¼ˆDesign/å·¦å´ï¼‰- ä½¿ç”¨ design_list
            const designContainer = document.getElementById('design-planet-list');
            if (designContainer && designList && Array.isArray(designList)) {
                let html = '';
                designList.forEach(planet => {
                    const planetName = planetNames[planet.planet] || planet.planet;
                    const planetIcon = planetIcons[planet.planet] || planet.planet.charAt(0);
                    const gateLineHtml = formatGateLine(planet, true);
                    html += `
                        <div class="planet-item">
                            <div class="planet-icon">${planetIcon}</div>
                            <div class="planet-name">${planetName}</div>
                            <div class="planet-gate-line">${gateLineHtml}</div>
                        </div>
                    `;
                });
                designContainer.innerHTML = html || '<div style="text-align: center; padding: 20px; color: #666;">ç„¡æ•¸æ“š</div>';
            } else if (designContainer) {
                designContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">ç­‰å¾…æ•¸æ“š...</div>';
            }

            // æ¸²æŸ“æ„è­˜å±¤ï¼ˆPersonality/å³å´ï¼‰- ä½¿ç”¨ personality_list
            const personalityContainer = document.getElementById('personality-planet-list');
            if (personalityContainer && personalityList && Array.isArray(personalityList)) {
                let html = '';
                personalityList.forEach(planet => {
                    const planetName = planetNames[planet.planet] || planet.planet;
                    const planetIcon = planetIcons[planet.planet] || planet.planet.charAt(0);
                    const gateLineHtml = formatGateLine(planet, true);
                    html += `
                        <div class="planet-item">
                            <div class="planet-icon">${planetIcon}</div>
                            <div class="planet-name">${planetName}</div>
                            <div class="planet-gate-line">${gateLineHtml}</div>
                        </div>
                    `;
                });
                personalityContainer.innerHTML = html || '<div style="text-align: center; padding: 20px; color: #666;">ç„¡æ•¸æ“š</div>';
            } else if (personalityContainer) {
                personalityContainer.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">ç­‰å¾…æ•¸æ“š...</div>';
            }
        }

        // é¡¯ç¤ºè¨Šæ¯
        function showMessage(message, type = 'error') {
            const messageArea = document.getElementById('message-area');
            const className = type === 'error' ? 'error-message' : 'success-message';
            messageArea.innerHTML = `<div class="${className}">${message}</div>`;
            setTimeout(() => {
                messageArea.innerHTML = '';
            }, 5000);
        }

        // è¡¨å–®æäº¤è™•ç†
        document.getElementById('birth-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const calculateBtn = document.getElementById('calculate-btn');
            const resultsContainer = document.getElementById('results-container');
            const messageArea = document.getElementById('message-area');
            
            // é©—è­‰æ˜¯å¦é¸æ“‡äº†ç¸£å¸‚å’Œå€åŸŸ
            const county = document.getElementById('county').value;
            const district = document.getElementById('district').value;
            if (!county || !district) {
                showMessage('è«‹é¸æ“‡ç¸£å¸‚å’Œå€åŸŸ', 'error');
                return;
            }
            
            // æ”¶é›†è¡¨å–®æ•¸æ“š
            const longitudeInput = document.getElementById('longitude');
            const latitudeInput = document.getElementById('latitude');
            const formData = {
                year: parseInt(document.getElementById('year').value),
                month: parseInt(document.getElementById('month').value),
                day: parseInt(document.getElementById('day').value),
                time: document.getElementById('time').value,
                timezone: document.getElementById('timezone').value.trim(),
                longitude: parseFloat(longitudeInput.value),
                latitude: parseFloat(latitudeInput.value)
            };

            // é©—è­‰æ•¸æ“š
            if (!formData.time || !formData.time.match(/^\d{2}:\d{2}$/)) {
                showMessage('è«‹è¼¸å…¥æœ‰æ•ˆçš„æ™‚é–“æ ¼å¼ (HH:MM)', 'error');
                return;
            }

            // ç¢ºä¿ç¶“ç·¯åº¦å·²æ ¹æ“šé¸æ“‡çš„ç¸£å¸‚å€åŸŸæ›´æ–°
            if (county && district) {
                // å¼·åˆ¶æ›´æ–°ä¸€æ¬¡ï¼Œç¢ºä¿ä½¿ç”¨æœ€æ–°çš„é¸æ“‡
                updateCoordinates(county, district);
                // é‡æ–°è®€å–æ›´æ–°å¾Œçš„å€¼
                formData.longitude = parseFloat(longitudeInput.value);
                formData.latitude = parseFloat(latitudeInput.value);
            }
            
            // é©—è­‰ç¶“ç·¯åº¦æ˜¯å¦æœ‰æ•ˆ
            if (isNaN(formData.longitude) || isNaN(formData.latitude)) {
                showMessage('ç¶“ç·¯åº¦æ•¸æ“šç„¡æ•ˆï¼Œè«‹é‡æ–°é¸æ“‡ç¸£å¸‚å’Œå€åŸŸ', 'error');
                return;
            }

            console.log('æäº¤è¡¨å–®æ•¸æ“š:', formData);

            // ç¦ç”¨æŒ‰éˆ•ï¼Œé¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            calculateBtn.disabled = true;
            calculateBtn.textContent = 'è¨ˆç®—ä¸­...';
            messageArea.innerHTML = '';

            try {
                // ç™¼é€ POST è«‹æ±‚åˆ°å¾Œç«¯ï¼ˆFlask APIï¼‰
                const response = await fetch('/calculate_hd', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                // æª¢æŸ¥éŸ¿æ‡‰ç‹€æ…‹
                if (!response.ok) {
                    // å˜—è©¦è§£æéŒ¯èª¤éŸ¿æ‡‰
                    let errorText = '';
                    try {
                        const errorResult = await response.json();
                        errorText = errorResult.error || `HTTP ${response.status}`;
                    } catch (e) {
                        errorText = await response.text() || `HTTP ${response.status}`;
                    }
                    showMessage(`ä¼ºæœå™¨éŒ¯èª¤: ${errorText}`, 'error');
                    return;
                }

                const result = await response.json();

                if (result.status === 'success' && result.data) {
                    // é¡¯ç¤ºçµæœå€åŸŸ
                    resultsContainer.classList.remove('hidden');
                    
                    // æ¸²æŸ“è¦–è¦ºåŒ–
                    renderHumanDesign(result.data);
                    
                    showMessage('è¨ˆç®—å®Œæˆï¼', 'success');
                } else {
                    showMessage(result.error || 'è¨ˆç®—å¤±æ•—ï¼Œè«‹æª¢æŸ¥è¼¸å…¥æ•¸æ“š', 'error');
                }
            } catch (error) {
                console.error('éŒ¯èª¤:', error);
                let errorMessage = 'ç„¡æ³•é€£æ¥åˆ°ä¼ºæœå™¨ã€‚è«‹ç¢ºä¿å¾Œç«¯æœå‹™æ­£åœ¨é‹è¡Œã€‚';
                if (error.message) {
                    errorMessage += ` (${error.message})`;
                }
                showMessage(errorMessage, 'error');
            } finally {
                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                calculateBtn.disabled = false;
                calculateBtn.textContent = 'è¨ˆç®—äººé¡åœ–';
            }
        });

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        function initializePage() {
            // åˆå§‹åŒ–ç¸£å¸‚é¸å–®
            initializeCountySelect();
            
            // è¨­ç½®äº‹ä»¶ç›£è½å™¨
            const countySelect = document.getElementById('county');
            const districtSelect = document.getElementById('district');
            
            if (countySelect && districtSelect) {
                // ç¸£å¸‚é¸æ“‡è®Šæ›´äº‹ä»¶
                countySelect.addEventListener('change', function() {
                    const county = this.value;
                    updateDistrictSelect(county);
                    // æ¸…ç©ºç¶“ç·¯åº¦ï¼ˆç­‰å¾…é¸æ“‡å€åŸŸå¾Œå†æ›´æ–°ï¼‰
                    if (!county) {
                        const longitudeInput = document.getElementById('longitude');
                        const latitudeInput = document.getElementById('latitude');
                        if (longitudeInput) longitudeInput.value = '121.5';
                        if (latitudeInput) latitudeInput.value = '25.0';
                    }
                });

                // å€åŸŸé¸æ“‡è®Šæ›´äº‹ä»¶
                districtSelect.addEventListener('change', function() {
                    const county = countySelect.value;
                    const district = this.value;
                    console.log('é¸æ“‡äº†å€åŸŸ:', { county, district });
                    if (county && district) {
                        updateCoordinates(county, district);
                    }
                });
            }

        // é‡ç½®æŒ‰éˆ•
            const resetBtn = document.getElementById('reset-btn');
            if (resetBtn) {
                resetBtn.addEventListener('click', function() {
            document.getElementById('birth-form').reset();
            document.getElementById('message-area').innerHTML = '';
            document.getElementById('results-container').classList.add('hidden');
                    initializeCountySelect();
                });
            }
        }

        // ç¢ºä¿ DOM è¼‰å…¥å¾ŒåŸ·è¡Œåˆå§‹åŒ–
        (function() {
            function init() {
                try {
                    console.log('é–‹å§‹åˆå§‹åŒ–é é¢...');
                    console.log('DOM readyState:', document.readyState);
                    console.log('taiwanLocations æ˜¯å¦å­˜åœ¨:', typeof taiwanLocations !== 'undefined');
                    
                    if (typeof taiwanLocations === 'undefined') {
                        console.error('taiwanLocations æœªå®šç¾©ï¼');
                        return;
                    }
                    
                    if (document.readyState === 'loading') {
                        console.log('ç­‰å¾… DOM è¼‰å…¥...');
                        document.addEventListener('DOMContentLoaded', initializePage);
                    } else {
                        console.log('DOM å·²æº–å‚™å¥½ï¼Œç«‹å³åŸ·è¡Œåˆå§‹åŒ–');
                        initializePage();
                    }
                } catch (error) {
                    console.error('åˆå§‹åŒ–éŒ¯èª¤:', error);
                }
            }
            
            // åŸ·è¡Œåˆå§‹åŒ–
            init();
        })();
    </script>
</body>
</html>

